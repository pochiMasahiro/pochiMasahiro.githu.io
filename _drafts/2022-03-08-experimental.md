---
layout: post
title: 
date: 2022-03-08 03:02
category: 
author: 
tags: []
summary: 
---

# 実験日程

- 1週目では、反転増幅回路の直流(DC)及び交流(AC)特性の実験を行う。
- 2週目では、反転増幅回路の入出力インピーダンス特性の実験を行う。

# 実験目的

オペアンプを用いた反転増幅回路を例として、

- オペアンプの電気的特性を示すパラメータ
- オペアンプの基本的な使用法

の2つを実験を通じて理解することを目指す。

# オペアンプの原理と反転増幅回路

## オペアンプの動作と回路図

オペアンプとはOperational Amplifier (演算増幅器) の略語である。演算の名の通り、四則演算や微分・積分の演算を行う回路、信号の増幅、インピーダンスの変換など多彩な回路が実現できる集積回路である。

オペアンプの回路は図?に示される形をしている。1つのオペアンプは5つの端子から構成されている。左側の2つの端子は入力端子であり、それぞれ正相入力端子、逆相入力端子と呼ばれる。三角形の頂点に接続される右側の端子は出力端子である。上下に向かって伸びる2つの端子は電源端子であり、一般的に上部は正電源が接続され、下部は負電源の端子が接続される。電源端子は省略されることも場合は図？(b)のように示される。

![opamp](/assets/opamp/opamp.png "オペアンプの回路図記号"){:width="300px" style="display:block; margin-left:auto; margin-right:auto"}

オペアンプは、「2つの入力端子の電圧差をオープンループゲイン倍に増幅して出力する」、という動作をする。式で表すと、

$$
\begin{equation}
V_o = A(V_+ - V_-)
\end{equation}
$$

となる。ここで、 $$A$$ はオープンループゲインと呼ばれる、オペアンプだけのゲインである。一般にオープンループゲイン $$A$$ は非常に大きく、100 dB以上を有する。

オペアンプそのものは、このように単純な動作しかしないが、帰還回路(出力を入力に戻す回路)を適切に設計することで、多彩な機能を有する回路を容易に実現できる。逆に言うとオペアンプを用いた回路というのは、そのほとんどが帰還回路により実現される。

## オペアンプの特性

オペアンプの特性を表す重要なパラメータとして以下の5つが挙げられる。ここでは、オペアンプの性質を理解するものとして理想オペアンプというものを考えて、これらのパラメータを説明する。

### 差動利得

オープンループゲインのことである。2つ入力の差分をどの程度増幅するのかを表す。理想オペアンプでは無限大となる。

### 同相利得

2つの入力端子に同じ信号が入力されたときに、その信号がどの程度増幅されるのかを表す。2つの入力端子に同じ信号が入れば、その差分は0になるので、理想オペアンプではゼロになる。

### 入力インピーダンス

オペアンプの入力端子は、入力の構造(バイポーラ、FET)にもよるが、ほとんど電流は流れないと考えることができ、メガオーム以上の入力インピーダンスを有する。理想オペアンプでは無限大として考える。

### 出力インピーダンス

オペアンプの出力端子に直列に存在するインピーダンスである。数百オーム程度の値を有する。理想オペアンプではゼロとして考える。

## オペアンプを用いた反転増幅回路

ここで用いるオペアンプとして、次のような条件を有する理想オペアンプであるとする。

1. オープンループゲイン $$A$$ は無限大
2. 入力インピーダンスは無限大
3. 出力インピーダンスはゼロ

以下、断りがなければ、その説明で用いるオペアンプは理想オペアンプを想定する。

図？はオペアンプを用いた反転増幅回路である。この回路について詳細に見ていく。オペアンプの逆相入力端子には抵抗 $$R_1$$を介して、入力 $$V_{in}$$ が接続され、また $$R_2$$ を介して出力 $$V_o$$ がフィードバックされている。

![inverted amp.](/assets/opamp/inverted_amp.png "オペアンプを用いた反転増幅回路"){:width="300px" style="display:block; margin-left:auto; margin-right:auto"}

まず、反転増幅回路全体のゲインを求める。オペアンプの出力 $$V_o$$ を求めるために、それぞれの入力端子の電位を求める。正相入力端子はGndに接続されているので、電位はゼロである。逆相入力端子の電位を求める。このとき、オペアンプの入力端子に電流は流れない(入力インピーダンス無限大)ため、入力端子から出力端子に至るまでの回路は次の図のようになる。

![partial](/assets/opamp/partial.png "反転増幅回路の入力から出力までの分圧回路"){:width="300px" style="display:block; margin-left:auto; margin-right:auto"}

この回路は分圧回路になっているので、反転入力端子の電位 $$V_-$$ は次のように表すことができる。

$$
\begin{equation}
V_- = \frac{R_1}{R_1+R_2}\left(V_o - V_{in}\right) + V_{in}
\end{equation}
$$

逆相入力端子の電位$$V_-$$ を、オペアンプの入出力の関係 $$V_o = A(V_+ - V_-)$$ に代入すると、次のように表される。

$$
\begin{aligned}
V_o & = -AV_- \\
& = -A \left\{\left(V_o - V_{in} \right) \frac{R_1}{R_1 + R_2} + V_{in}\right\} \\
\end{aligned}
$$

この式を $$V_o$$ について解くことで、

$$
\begin{equation}
V_o = \frac{\frac{AR_1}{R_1+R_2} - A}{1 + \frac{AR_1}{R_1+R_2}} V_{in}
\end{equation}
$$

となる。オペアンプのオープループゲインは無限大なので、 $$A \rightarrow \infty$$ の極限を考えると、

$$
\begin{aligned}
V_o & = \lim_{A \rightarrow \infty}{\frac{\frac{AR_1}{R_1+R_2} - A}{1 + \frac{AR_1}{R_1+R_2}} V_{in}} \\
& = \lim_{A \rightarrow \infty}{\frac{\frac{R_1}{R_1+R_2} - 1}{\frac{1}{A} + \frac{R_1}{R_1+R_2}} V_{in}} \\
& = -\frac{R_2}{R_1} V_{in}
\end{aligned}
$$

となり、反転増幅回路全体のゲインは $$-\frac{R_2}{R_1}$$ となる。

## バーチャルショートを用いた計算方法

バーチャルショート(仮想短絡)とは、オペアンプの入力端子 $$V_+$$ と $$V_-$$ が短絡(ショート)されたように等しい電圧を示すことを言う。非常に高いオープンループゲインを有する作動増幅回路を負帰還回路で使用するときに現れる性質のことである。「ショート」という言葉を用いているが、あくまでも電位が等しくなるだけで、電流は流れない。

負帰還のオペアンプ回路は、バーチャルショートを用いることで、先程のような極限を考えるなどの操作を一切せずに非常に簡単に計算することができるようになる。先程と同じ反転増幅回路を、バーチャルショートを用いて計算してみる。

バーチャルショートを用いると、 $$V_+$$ がGndに接続されているため、

$$
\begin{equation}
V_- = V_+ = 0
\end{equation}
$$

となる。 $$R_1$$ に流れる電流 $$I_1$$ は、 $$V_- = 0$$ なので

$$
\begin{aligned}
I_1 &= \frac{V_{in} - V_-}{R_1} \\
&= \frac{V_{in}}{R_1}
\end{aligned}
$$

となる。オペアンプの入力端子には電流は流れないので、 $$I_1$$ はすべて抵抗 $$R_2$$ に流れる。出力電圧 $$V_o$$ は帰還抵抗 $$R_2$$ を介して $$V_-$$ 端子に接続されているので、

$$
\begin{aligned}
V_o - V_- & = -R_2I_1 \\
V_o & = -R_2 I_1
\end{aligned}
$$

と表される。電流 $$I_1$$ を代入することで、

$$
\begin{equation}
V_o = -\frac{R_2}{R_1} V_{in}
\end{equation}
$$

となる。

このようにバーチャルショートを使うことで、オープンループゲインの極限を考えることなく容易に負帰還回路のゲインを求めることができる。バーチャルショートの性質を考えると、負帰還回路におけるオペアンプは、2つの入力端子が同電位となるように出力端子の電圧を調整する役割を担っていると考えることもできる。

# 現実のオペアンプの電気的特性

オペアンプ回路を理解するのに理想オペアンプを用いた近似は非常に有用である。しかし、現実のオペアンプでは、オープンループゲインは有限で、しかも、周波数特性を有する。また、入力インピーダンスも有限なので入力端子への電流の流入がある。入力差動回路の誤差により生じるオフセットも存在する。理想オペアンプと現実のオペアンプの違いを整理し、現実のオペアンプのデータシートから代表的なパラメータの読み方を説明する。

## 入出力の電気的特性

## オープンループゲイン

## GB積

## 入力換算オフセット電圧/電流

# 実験

## 1週目：反転増幅回路のDC/AC特性 

## 2週目：反転増幅器の入出力インピーダンス

# 考察課題
